\subsection{Аудиторне заняття}

\begin{problem}
	Знайти оптимальне керування, оптимальну траєкторію, функцію Белмана і оптимальне значення критерія якості задачі оптимального керування \[ \JJ(\{u(k)\},\{x(k)\}) = \sum_{k=0}^2 u^2(k) + x^2(3) \to \inf \] за умов \[ x(k + 1) = 2 x(k) + u(k), \quad x(0) = 1, k = 0,1,2.\] Тут $x,u\in\RR^1$.
\end{problem}

\begin{solution}
	Випишемо функції що фігурують в задачі: \[ g_k (x (k), u (k)) = u^2 (k), \quad \Phi (x (N)) = x^2 (3), \quad f_k (x (k), u (k)) = 2 x (k) + u (k). \]

	\[\BB_3 (z) = \Phi (z) = z^2. \]

	Послідовно знаходимо $u_*$:
	\begin{enumerate}

	\item Запишемо визначення $u_*(2)$:
	\begin{multline*} 
		u_*(2) = \argmin_{u(2)} (g_2(z, u(2)) + \BB_3(f_2(z,u(2)))) = \\
		= \argmin_{u(2)} (u^2(2) + f_2^2(z, u(2))) = \\
		= \argmin_{u(2)} (u^2(2) + (2 z + u(2))^2).
	\end{multline*}

	Знайдемо $u_*(2)$ з умови 
	\[ 0 = \frac{\partial}{\partial u(2)} \left(u_*^2(2) + (2 z + u_*(2))^2 \right) = 2 u_*(2) + 2 (2 z + u_*(2)) = 4 u_*(2) + 4 z,\]

	звідки $u_*(2) = - z$. \\

	Знайдемо
	\begin{multline*}
		\BB_2 (z) = (g_2(z, u_*(2)) + \BB_3(f_2(z,u_*(2)))) = \\
		= u_*^2(2) + (2 z + u_*(2))^2 = z^2 + (2 z - z)^2 = 2 z^2.
	\end{multline*}

	\item Запишемо визначення $u_*(1)$:
	\begin{multline*} 
		u_*(1) = \argmin_{u(1)} (g_1(z, u(1)) + \BB_2(f_1(z,u(1)))) = \\
		= \argmin_{u(1)} (u^2(1) + 2 f_1^2(z, u(1))) = \\
		= \argmin_{u(1)} (u^2(1) + 2 (2 z + u(1))^2).
	\end{multline*}

	Знайдемо $u_*(1)$ з умови 
	\[ 0 = \frac{\partial}{\partial u(1)} \left(u_*^2(1) + 2 (2 z + u_*(1))^2 \right) = 2 u_*(1) + 4 (2 z + u_*(1)) = 6 u_*(1) + 8 z,\]

	звідки $u_*(1) = - \frac43 z$. \\

	Знайдемо
	\begin{multline*}
		\BB_1 (z) = (g_1(z, u_*(1)) + \BB_2(f_1(z,u_*(1)))) = \\
		= u_*^2(1) + 2 (2 z + u_*(1))^2 = \frac{16}{9} z^2 + 2 \left(2 z - \frac43z\right)^2 = \frac{8}{3} z^2.
	\end{multline*}


	\item Запишемо визначення $u_*(0)$:
	\begin{multline*} 
		u_*(0) = \argmin_{u(0)} (g_0(z, u(0)) + \BB_1(f_0(z,u(0)))) = \\
		= \argmin_{u(0)} (u^2(0) + \frac{8}{3} f_0^2(z, u(0))) = \\
		= \argmin_{u(0)} (u^2(0) + \frac{8}{3} (2 z + u(0))^2).
	\end{multline*}

	Знайдемо $u_*(0)$ з умови 
	\begin{multline*} 
		0 = \frac{\partial}{\partial u(0)} \left(u_*^2(0) + \frac{8}{3} (2 z + u_*(0))^2 \right) = \\
		= 2 u_*(0) + \frac{16}{3} (2 z + u_*(0)) = \frac{22}{3} u_*(0) + \frac{32}{3} z,
	\end{multline*}	

	звідки $u_*(0) = - \frac{16}{11} z$. \\

	Знайдемо
	\begin{multline*}
		\BB_0 (z) = (g_0(z, u_*(0)) + \BB_1(f_0(z,u_*(0)))) = \\
		= u_*^2(0) + \frac{8}{3} (2 z + u_*(0))^2 = \frac{256}{121} z^2 + \frac{8}{3} \left(2 z - \frac{16}{11} z\right)^2 = \frac{32}{11} z^2.
	\end{multline*}
	\end{enumerate}

	Оскільки $\XX_0 = \{ x_0 \}$, то $x_*(0) = x_0$, $\JJ_* = \frac{32 x_0^2}{11}$. \\

	Відновимо тепер траєкторію: 
	\begin{enumerate}
		\item \[x_*(1) = f_0(x_*(0), u_*(0)) = 2 x_0 + u_*(0) = 2 x_0 - \frac{16}{11} x_0 = \frac{6 x_0}{11}.\]
		\item \[x_*(2) = f_1(x_*(1), u_*(1)) = 2 \frac{6 x_0}{11} + u_*(1) = \frac{12 x_0}{11} - \frac{4}{3} \frac{6 x_0}{11} = \frac{4 x_0}{11}.\]
		\item \[x_*(3) = f_2(x_*(2), u_*(2)) = 2 \frac{4 x_0}{11} + u_*(2) = \frac{8 x_0}{11} -  \frac{4 x_0}{11} = \frac{4 x_0}{11}.\]
	\end{enumerate}
\end{solution}

\begin{problem}
	Знайти оптимальне керування і функцію Белмана задачі оптимального керування \[ \JJ ( \{ u (k) \}, \{ x (k) \} ) = \sum_{k = 0}^{N - 1} u^2 (k) + x^2 (N) \to \inf \] за умов \[ x (k + 1) = x (k) + u (k), x (0) = x_0, k = 0, 1, \ldots, N - 1. \] Тут $x, u \in \RR^1$. Точка $x_0 \in \RR^1$ -- відома.
\end{problem}

\begin{solution}
	Будемо шукати функцію Белмана у вигляді \[ \BB_s(z) = b (s) \cdot z^2. \] Зауважимо, що $\BB_N(z) = z^2$, тому $b(N) = 1$. \\

	Далі записуємо дискретне рівняння Белмана \[ b (s) \cdot z^2 = \min_u ( u^2 + b (s + 1) \cdot ( z + u )^2 ). \]

	Знайдемо $u_*$ з умови \[ 0 = \frac{\partial}{\partial u} \left( u^2 + b (s + 1) \cdot ( z + u )^2 \right) = 2 u + 2 b (s + 1) ( z + u ), \] звідки \[ u_* (s) = - \frac{ b (s + 1) \cdot x (s) }{ 1 + b (s + 1) }. \]

	Підставляючи це у дискретне рівняння Белмана отримаємо дискретне рівняння для знаходження $b (s)$: \[ b (s) = \frac{ b (s + 1) }{ b (s + 1) + 1 }. \]

	Звідси нескладно отримати $b (N - k) = \frac{1}{k + 1}$, зокрема $b (0) = \frac{1}{N + 1}$. \\

	Далі нескладно отримати \[u_* (s) = - \frac{x_0}{N + 1},\] а \[x_* (s) = \frac{ N - s }{ N + 1 } \cdot x_0.\]

	Воно й не дивно, бо задача має вигляд \[ u_0^2 + u_1^2 + \ldots + u_{n-1}^2 + (x_0 - u_0 - u_1 - \ldots - u_{n-1})^2 \to \min \] Тобто мінімізуємо суму квадратів чисел зі сталою ($x_0$) сумою. \\

	За теоремою Штурма, мінімум суми квадратів досягається коли всі ці квадрати рівні (і дорівнюють $\frac{1}{(N + 1)^2}$), це відповідає знайденому нами керуванню.
\end{solution}

\begin{problem}
	Знайти оптимальне керування і функцію Белмана задачі оптимального керування \[ \JJ ( \{ u (k) \}, \{ x (k) \} ) = \sum_{k = 0}^{N - 1} (u(k) - v(k))^2 + x^2 (N) \to \inf \] за умов \[ x (k + 1) = x (k) + u (k), x (0) = x_0, k = 0, 1, \ldots, N - 1. \] Тут $x, u \in \RR^1$. Точка $x_0 \in \RR^1$ -- відома, $v(k)$ -- відомі, $k=0,1,\ldots,N-1$.
\end{problem}

\begin{solution}
	Будемо шукати функцію Белмана у вигляді \[ \BB_s (z) = p (s) \cdot z^2 + q (s) \cdot z + r (s). \] Зауважимо, що $\BB_N (z) = z^2$, тому $p (N) = 1$, $q (N) = r (N) = 0$. \\

	Далі записуємо дискретне рівняння Белмана \begin{multline*} p (s) \cdot z^2 + q (s) \cdot z + r (s) = \\ = \min_u ( (u - v)^2 + p (s + 1) \cdot (z + u)^2 + q (s + 1) \cdot (z + u) + r (s + 1) ). \end{multline*}

	Знайдемо $u_*$ з умови \begin{multline*} 0 = \frac{\partial}{\partial u} \left( (u - v)^2 + p (s + 1) \cdot (z + u)^2 + q (s + 1) \cdot (z + u) + r (s + 1) \right) = \\ = 2 (u - v) + 2 p (s + 1) \cdot (z + u) + q (s + 1), \end{multline*} звідки \[ u_* (s) = \frac{ 2 v (s) - 2 p (s + 1) x (s) - q (s + 1) }{ 2 + 2 p (s + 1) }. \]

	Підставляючи це у дискретне рівняння Белмана отримаємо дискретне рівняння для знаходження $p (s)$, $q (s)$, $r (s)$:
	\begin{multline*} p (s) \cdot z^2 + q (s) \cdot z + r (s) = \left( \frac{2 v (s) - 2 p (s + 1) z - q (s + 1)}{2 + 2 p (s + 1)} - v (s) \right) + \\ + p (s + 1) \cdot \left( z + 2 v (s) - 2 p (s + 1) z - q (s + 1) \right)^2 + \\ + q (s + 1) \cdot \left( z + 2 v (s) - 2 p (s + 1) z - q (s + 1) \right) + r (s + 1) \end{multline*}

	Збираючи коефіцієнти при відповідних степенях $z$ знаходимо систему для знаходження $p (s)$, $q (s)$, $r (s)$.
\end{solution}

\begin{problem}
	% 9.4
\end{problem}

\begin{solution}
	% 9.4
\end{solution}

\begin{problem}
	% 9.5
\end{problem}

\begin{solution}
	% 9.5
\end{solution}
