\subsection{Задачі з розв'язками}

\begin{problem}
	Задана скалярна система керування 
	
	\begin{equation}
		\label{eq:1.1}
		\frac{\diff x(t)}{\diff t} = u(t), \quad x(0) = 1.
	\end{equation}
	Тут $x$ -- стан системи, $t \in [0, 1]$. Керування задане у вигляді
	\begin{equation}
		\label{eq:1.2}
		u(x) = a x,
	\end{equation}
	де $a$ -- скалярний параметр.

	\begin{enumerate}
		\item Знайти траєкторію системи (\ref{eq:1.1}) при керуванні (\ref{eq:1.2}).

		\item Знайти програмне керування $u(t) = a x (t)$, яке відповідає знайденій траєкторії. 

		\item Оцінити, при якому значенні параметра $a \in \{2, 4, -3\}$ критерій якості $\JJ(u) = x^2 (1)$ буде мати менше значення.
	\end{enumerate}
\end{problem}

\begin{solution}
    Скористаємося алгоритмом \ref{algo-1-1}.
    
	\begin{enumerate}
	    \item Керування  \eqref{eq:1.2} є керуванням з оберненим зв'язком, оскільки залежить від стану системи $x$. Підставляючи керування (\ref{eq:1.2}) у систему (\ref{eq:1.1}), отримаємо систему \[ \frac{\diff x(t)}{\diff t} = a x(t), \quad x(0) = 1. \]
		Її розв'язок має вигляд \[ x(t) = x(0) \cdot e^{a t} = e^{a t}. \]
		\item Знайдемо програмне керування, яке відповідає керуванню з оберненим зв'язком \eqref{eq:1.2}. Для цього траєкторію, що була знайдена на попередньому кроці, підставляємо в \eqref{eq:1.2} \[ u(t) = a x(t) = a \cdot e^{a t}. \]
		\item З того, що, $x(1) = e^{a}$ випливає, що 
		\[\JJ(u) = x^2 (1)=e^{2a}.\]
		Множина $\{2, 4, -3\}$ скінченна, тому можна  перебрати всі її елементи та обчислити значення критерію якості на кожному з них. Одержуємо 
		
		\[ \left.\JJ (u) \right|_{a = 2} = e^4, \  \left. \JJ (u) \right|_{a = 4} = e^8, \ \left. \JJ (u) \right|_{a = -3} = e^{-6}. \]
		Найменшим з цих значень є $e^{-6}$, яке досягається при $a = -3$.
	\end{enumerate}
\end{solution}

\begin{problem}
	Задана система керування

	\begin{equation}
		\label{eq:1.3}
		\left\{
			\begin{aligned}
				\frac{\diff x_1 (t)}{\diff t} &= x_1 (t) + x_2 (t) + u (t), \\
				\frac{\diff x_2 (t)}{\diff t} &= - x_1 (t) + x_2 (t) + u(t),
			\end{aligned}
		\right.
		\quad
		x_1 (0) = 2, x_2 (0) = 1.
	\end{equation}

	Тут $x = (x_1, x_2)^*$ -- вектор фазових координат з $\RR^2$, $t \in [0, T]$. Керування задане у вигляді

	\begin{equation}
		\label{eq:1.4}
		u(x_1, x_2) = 2 x_1 + x_2.
	\end{equation}

	\begin{enumerate}
		\item Знайти траєкторію системи (\ref{eq:1.3}) при керуванні (\ref{eq:1.4}).

		\item Знайти програмне керування $u(t) = 2 x_1 (t) + x_2 (t)$, яке відповідає знайденій траєкторії.

		\item Якою буде фундаментальна матриця, нормована за моментом $s$, системи. що одержана при підстановці керування (\ref{eq:1.4}) у систему (\ref{eq:1.3})?

		\item Побудувати спряжену систему до системи, одержаної при підстановці керування (\ref{eq:1.4}) у систему (\ref{eq:1.3}), та її фундаментальну матрицю.
	\end{enumerate}
\end{problem}

\begin{solution}
    Скористаємося пунктами 2, 3, 5-7 алгоритму \ref{algo-1-1}:
    
	\begin{enumerate}
		\item Підставляючи керування (\ref{eq:1.4}) у систему (\ref{eq:1.3}), отримаємо систему \[
		\left\{
			\begin{aligned}
				\frac{\diff x_1 (t)}{\diff t} &= 3 x_1 (t) + 2 x_2 (t), \\
				\frac{\diff x_2 (t)}{\diff t} &= x_1 (t) + 2 x_2 (t),
			\end{aligned}
		\right.
		\quad
		x_1 (0) = 2, x_2 (0) = 1.
		\]

		Її розв'язок \[
		\left\{
			\begin{aligned}
				x_1 (t) &= 2 e^{4 t}, \\
				x_2 (t) &= e^{4 t}.
			\end{aligned}
		\right.
		\]

		\item Підставляємо знайдену у попередньому пункті траєкторію у вигляд (\ref{eq:1.4}) керування: \[ u(t) = 2 x_1 (t) + x_2 = 2 \cdot \left( 2 e^{4 t} \right) + e^{4 t} = 5 e^{4 t}. \]

		\item Загальним розв'язком системи (\ref{eq:1.3}) з підставленим керуванням (\ref{eq:1.4}) є \[
		\left\{
			\begin{aligned}
				x_1 (t) &= c_1 e^t + 2 c_2 e^{4 t}, \\
				x_2 (t) &= - c_1 e^t + c_2 e^{4 t}.
			\end{aligned}
		\right.
		\]

		Це означає, що фундаментальна матриця цієї системи матиме вигляд \[
			\Theta(t) = 
			\begin{pmatrix}
				c_{11} e^t + 2 c_{12} e^{4 t} & c_{21} e^t + 2 c_{22} e^{4 t} \\
				- c_{11} e^t + c_{12} e^{4 t} & - c_{21} e^t + c_{22} e^{4 t}
			\end{pmatrix}
		\]

		Залишається нормувати її за моментом $s$, тобто знайти такі $c_{11} (s)$, $c_{12} (s)$, $c_{21} (s)$, $c_{22} (s)$, що $\Theta(s, s) = I$. Отримаємо \[
			\Theta(t, s) = \frac{1}{3}
			\begin{pmatrix}
				e^{t - s} + 2 e^{4 (t - s)} & -2 e^{t - s} + 2 e^{4 (t - s)} \\
				e^{t - s} - e^{4 (t - s)} & 2 e^{t - s} + e^{4 (t - s)}
			\end{pmatrix}
		\]

		\item Спряжена система
		\[
		\left\{
			\begin{aligned}
				\frac{\diff z_1 (t)}{\diff t} &= - 3 z_1 (t) - z_2 (t), \\
				\frac{\diff z_2 (t)}{\diff t} &= - 2 z_1 (t) - 2 z_2 (t),
			\end{aligned}
		\right.
		\]

		а відповідна фундаментальна матриця \[ \Psi(t, s) = \Theta^*(s, t) = \frac{1}{3}
			\begin{pmatrix}
				e^{s - t} + 2 e^{4 (s - t)} & e^{s - t} - e^{4 (s - t)} \\
				-2 e^{s - t} + 2 e^{4 (s - t)} & 2 e^{s - t} + e^{4 (s - t)}
			\end{pmatrix}
		\]
	\end{enumerate}
\end{solution}

\begin{problem}
	Розглядається задача Больца \[ \JJ (u) = \int_0^1 u^2 (s) \diff s + ( x (1) - 2 )^2 \to \inf \]

	за умови, що \[ \frac{\diff x (t)}{\diff t} = x^2 (t) + u (t), \quad x (0) = x_0. \]

	Тут $x (t) \in \RR^1$, $u (t) \in \RR^1$, $t \in [0, 1]$. Точка $x_0 \in \RR^1$ задана. Звести цю задачу до задачі Майєра.
\end{problem}

\begin{solution}
    Скористаємося алгоритмом \ref{algo-1-2}:

	Введемо нову змінну \[ x_2 = \int_0^t u^2 (s) \diff s, \] 

	тоді \[ \JJ (u) = x_2 (1) + ( x_1 (1) - 2)^2 \to \inf, \]

	за умов, що \[ 
	\left\{
		\begin{aligned}
			\frac{\diff x_1 (t)}{\diff t} &= x_1^2 (t) + u (t), \\
			\frac{\diff x_2 (t)}{\diff t} &= u^2 (t).
		\end{aligned}
	\right.
	\quad
	x_1 (0) = x_0, x_2 (0) = 0.
	\]
\end{solution}

\begin{problem}
	Задана система керування 
	\[
		\left\{
			\begin{aligned}
				\dfrac{\diff x_1(t)}{\diff t} &= 2x_1(t) + x_2(t) + u(t), \\
				\dfrac{\diff x_2(t)}{\diff t} &= 3x_1(t) + 4x_2(t),
			\end{aligned}
		\right.
		\quad
		x_1(0) = 1, x_2(0) = -1.
	\]

	Тут $x = (x_1, x_2)^*$ -- вектор фазових координат з $\RR^2$, $t \in [0, 2]$. Керування задане у вигляді
	\[
		u(t) 
		=
		\begin{cases}
			0, & \text{якщо } t \in [0, 1], \\
			1, & \text{якщо } t \in (1, 2].
		\end{cases}
	\]
	
	\begin{enumerate}
		\item Знайти траєкторію системи, яка відповідає цьому керуванню.
		\item Чи буде ця траєкторія неперервно диференційовною?
		\item Чи буде таке керування кращим в порівнянні з керуванням $u(t) = 0$, $t \in [0, 2]$ 
		за умови, що критерій якості має вигляд 
		\[ \JJ (u) = x_1^2(2) + x_2^2(2) \to \min. \]
	\end{enumerate}
\end{problem}

\begin{solution}
    Скористаємося пунктами 2-5 алгоритму \ref{algo-1-1}:
    
	\begin{enumerate}
		\item При $t \in [0, 1]$ маємо 
		\[ \begin{pmatrix} \dot x_1 \\ \dot x_2 \end{pmatrix} = \begin{pmatrix}	2 & 1 \\ 3 & 4 \end{pmatrix} \cdot \begin{pmatrix} x_1 \\ x_2 \end{pmatrix}.\]
		
		Характеристичне рівняння 
		\[ \begin{vmatrix} 2 - \lambda & 1 \\ 3 & 4 - \lambda \end{vmatrix} = \lambda^2 - 6\lambda + 5 = 0,\]
		звідки $\lambda_1 = 1$, $\lambda_2 = 5$.\\
		
		З курсу диференціальних рівнянь відомо, що загальний розв'язок має вигляд
		\[ x = c_1 v_1 e^t + c_2 v_2 e^{5t},\]
		де $v_1$, $v_2$ -- власні вектори, що відповідають $\lambda_1$ та $\lambda_2$ відповідно. Підставляючи $\lambda_i$, $i=1,2$, знаходимо
		\[ \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} = c_1 \begin{pmatrix} 1 \\ -1 \end{pmatrix} e^t + c_2 \begin{pmatrix} 1 \\ 3 \end{pmatrix} e^{5t}.\]
		
		Підставляючи $t = 0$ отримуємо $c_1 = 1$, $c_2 = 0$. При $t \in (1, 2]$ маємо 
		\[ \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} = c_1 v_1 e^t + c_2 v_2 e^{5t} + \begin{pmatrix} c_3 \\ c_4 \end{pmatrix}, \]
		де $c_3$, $c_4$ задовольняють систему 
		\[
			\left\{
				\begin{aligned}
					2c_3 &+ c_4 + 1 &= 0, \\
					3c_3 &+ 4c_4 &= 0,
				\end{aligned}
			\right.
		\]
		звідки $c_3 = -4/5$, $c_4 = 3/5$ і 
		\[ \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} = c_1 v_1 e^t + c_2 v_2 e^{5t} + \begin{pmatrix} -4/5 \\ 3/5 \end{pmatrix},\]
		
		Підставляючи $t = 1$ отримуємо $c_1 = \left(1 + \dfrac{3}{4e}\right)$, $c_2 = \dfrac{1}{20e^5}$. Остаточно маємо 
		\[ \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} = \begin{cases} \begin{pmatrix} 1 \\ -1 \end{pmatrix} e^t, & t \in [0, 1], \\ \left(1 + \dfrac{3}{4e}\right) \begin{pmatrix} 1 \\ -1 \end{pmatrix} e^t + \dfrac{1}{20e^5} \begin{pmatrix} 1 \\ 3 \end{pmatrix} e^{5t} + \begin{pmatrix} -4/5 \\ 3/5 \end{pmatrix}, & t \in (1, 2]. \end{cases}\]
		
		\item 
		\[ \dot x (1-) = \begin{pmatrix} 2 & 1 \\ 3 & 4	\end{pmatrix} \cdot x(1-). \]
		
		З неперервності $x_1$, $x_2$ маємо:
		\[ \begin{pmatrix} 2 & 1 \\ 3 & 4 \end{pmatrix} \cdot x(1-) = \begin{pmatrix} 2 & 1 \\ 3 & 4 \end{pmatrix} \cdot x(1). \]
		
		З іншого боку,
		\[ \dot x (1+) = \begin{pmatrix} 2 & 1 \\ 3 & 4 \end{pmatrix} \cdot x(1+) + \begin{pmatrix} 1 \\ 0 \end{pmatrix} = \begin{pmatrix} 2 & 1 \\ 3 & 4 \end{pmatrix} \cdot x(1) + \begin{pmatrix} 1 \\ 0 \end{pmatrix} \]
		
		Нескладно бачити, що 
		\[ \dot x (1-) \ne \dot x (1+), \]
		тобто траєкторія не є неперервно диференційовною в точці $1$.
		
		\item 
		Підставимо $t=2$ в розв'язки для обох керувань (%попутно зауваживши
		зауважимо, що для нового керування розв'язок ми вже знаємо, це просто продовження вже знайденого розв'язку для $t \in [0, 1]$). Значення критерію якості на першому керуванні буде
		\[ \left(e^2 + \dfrac34e + \dfrac{e^5}{20} - \dfrac45\right)^2 + \left(-e^2 - \dfrac34e + \dfrac{3e^5}{20} + \dfrac35\right)^2, \]
		а на другому $(e^2)^2 + (-e^2)^2$. \\

	    Виконавши обчислення знаходимо, що другий вираз менше, тобто нове керування є кращим за початкове.
	\end{enumerate}
\end{solution}

\begin{problem}
	Задана система керування 
	\begin{equation}
		\label{eq:1.5}
		\left\{
			\begin{aligned}
				\dfrac{\diff x_1(t)}{\diff t} &= -8x_1(t)  -x_2(t) + u(t),\\
				\dfrac{\diff x_2(t)}{\diff t} &= 6x_1(t) + 3x_2(t),
			\end{aligned}
		\right.
		\quad
		x_1(0) = -2, x_2(0) = 1.
	\end{equation}

	Тут $ x =(x_1, x_2)^*$ -- вектор фазових координат з $\RR^2$, $t \in [0, 1]$. Керування задане у вигляді
	\begin{equation}
		\label{eq:1.6}
		u(x_1, x_2) = 4x_1 - x_2.
	\end{equation}

	\begin{enumerate}
		\item До якого класу керувань належить керування (\ref{eq:1.6}): програмних, чи з оберненим зв'язком?
		\item Знайти траєкторію системи при керуванні (\ref{eq:1.6}).
		\item Знайти програмне керування $u(t) = 4x_1(t) - x_2(t)$, яке відповідає знайденій траєкторії.
		\item Якою буде фундаментальна матриця, нормована за моментом $s$, системи, що одержана при підстановці керування (\ref{eq:1.6}) в систему (\ref{eq:1.5})?
		\item Побудувати спряжену систему до системи (\ref{eq:1.6}), одержаної при підстановці керування (\ref{eq:1.6}) в систему (\ref{eq:1.5}), та її фундаментальну матрицю.
	\end{enumerate}
\end{problem}

\begin{solution}
	\begin{enumerate}
		\item З оберненим зв'язком.
		\item 
		\[
			\begin{pmatrix}
				\dot x_1 \\ 
				\dot x_2
			\end{pmatrix}
			=
			\begin{pmatrix}
				-4 & -2 \\
				6 & 3
			\end{pmatrix}
			\begin{pmatrix}
				x_1 \\
				x_2
			\end{pmatrix}.
		\]
		Характеристичне рівняння 
		\[
			\begin{vmatrix}
				-4 - \lambda & -2 \\
				6 & 3 - \lambda 
			\end{vmatrix}
			=
			\lambda^2 + \lambda 
			=
			(\lambda + 1) \lambda
			=
			0,
		\]
		звідки $\lambda_1 = -1$, $\lambda_2 = 0$.\\
		
		З курсу диференційних рівнянь відомо, що тоді загальний розв'язок має вигляд
		\[
			\begin{pmatrix}
				x_1 \\
				x_2
			\end{pmatrix}
			=
			c_1 v_1 e^{-t} + c_2 v_2,
		\]
		де $v_1$, $v_2$ -- власні вектори, що відповідають $\lambda_1$ та $\lambda_2$ відповідно.\\
		
		Нескладно бачити, що 
		\[
			\begin{pmatrix}
				x_1 \\
				x_2
			\end{pmatrix}
			=
			c_1 
			\begin{pmatrix}
				1 \\
				-2
			\end{pmatrix} 
			+ 
			c_2 
			\begin{pmatrix}
				2 \\
				-3
			\end{pmatrix}
			e^{-t} .
		\]
		
		Підставляючи $t=0$ отримуємо $c_1 = 4$, $c_2 = -3$.\\
		
		Остаточно маємо:
		\[
			\begin{pmatrix}
				x_1 \\
				x_2
			\end{pmatrix}
			=
			4
			\begin{pmatrix}
				1 \\
				-2
			\end{pmatrix} 
			-3
			\begin{pmatrix}
				2 \\
				-3
			\end{pmatrix}
			e^{-t}
			.
		\]
		\item Просто підставляємо знайдені $x_1(t)$, $x_2(t)$ в $u(x_1, x_2)$:
		\[
			u(t)
			=
			4\left(4\cdot (1) - 3\cdot (2)\cdot e^{-t}\right)
			-
			\left(4\cdot (-2) - 3\cdot (-3)\cdot e^{-t}\right)
			=
			24 - 33e^{-t}.
		\]
		\item З вигляду загального розв'язку бачимо, що вищезгадана фундаментальна матриця матиме вигляд
		\[
			\Theta(t,s)
			=
			\begin{pmatrix}
				c_1 + 2c_2 e^{s-t} & c_3 + 2c_4 e^{s-t} \\
				-2c_1 - 3c_2 e^{s-t} & -2c_3 - 3c_4 e^{s-t} 
			\end{pmatrix},
		\]
		причому 
		\[
			\left\{
				\begin{aligned}
					c_1   &+ 2c_2 &= 1 \\
					-2c_1 &- 3c_2 &= 0
				\end{aligned}
			\right.		
		\]
		(і аналогічна система для $c_3$, $c_4$).\\
		
		Знаходимо $c_1 = -3$, $c_2 = 2$, $c_3 = -2$, $c_4 = 1$ і підставляємо у матрицю:
		\[
			\Theta(t,s)
			=
			\begin{pmatrix}
				-3 + 4e^{s-t} & -2 + 2e^{s-t} \\
				6 - 6e^{s-t} & 4 - 3e^{s-t} 
			\end{pmatrix},
		\]
		
		\item Спряжена система буде
		\[
			\begin{pmatrix}
				\dot y_1 \\
				\dot y_2
			\end{pmatrix}
			=
			\begin{pmatrix}
				4 & -6 \\
				2 & -3
			\end{pmatrix}
			\begin{pmatrix}
				y_1 \\
				y_2
			\end{pmatrix},
		\]
		а відповідна фундаметальна матриця
		\[
			\Psi(t,s)
			=
			\Theta^*(s,t)
			=
			\begin{pmatrix}
				-3 + 4e^{t-s} & 6 - 6e^{t-s} \\
				-2 + 2e^{t-s} & 4 - 3 e^{t-s}
			\end{pmatrix},
		\]
	\end{enumerate}
\end{solution}

\begin{problem}
	Розглядається задача Лагранжа
		\[
		\JJ(u)
		=
		\int_0^T u^2(s) \diff s \to \inf
		\]
		за умови, що
		\[
			\left\{
				\begin{aligned}
					\dfrac{\diff x_1(t)}{\diff t} &= -x_1(t) + x_2(t) + u(t), \\
					\dfrac{\diff x_2(t)}{\diff t} &= x_1(t) \cdot x_2(t),
				\end{aligned}
			\right.
			\quad
			x_1(0)=0, x_2(0)=1.
		\]
		Тут $x=(x_1,x_2)^*$ -- вектор фазових координат з $\RR^2$, $t\in[0,T]$. Звести цю задачу до задачі Майєра.
\end{problem}

\begin{solution}
	Введемо нову фазову координату $x_3(t)=\int_0^t u^2(s) \diff s$, тоді до системи додається початкова умова $x_3(0)=0$, рівняння $\dot x_3 = u^2$, а функціонал якості переписується у вигляді $x_3(T) \to \inf$.
\end{solution}


\begin{problem}
	Задана система керування \[ \left\{ \begin{aligned}
		\frac{\diff x_1 (t)}{\diff t} &= - x_1 (t) - 5 x_2 (t), \\
		\frac{\diff x_2 (t)}{\diff t} &= x_1 (t) + x_2 (t) + u(t),
	\end{aligned} \right. 
	\quad x_1 (0) = 0, x_2 (0) = 1. \]
	Тут $x = (x_1, x_2)^*$ -- вектор фазових координат з $\RR^2$, $t \in [0, 2]$. Керування задане у вигляді \[ u(t) = \begin{cases} 0, & \text{якщо } t \in [0, 1], \\ t, & \text{якщо } t \in (1, 2]. \end{cases} \]
	\begin{enumerate}
		\item До якого класу керувань належить таке керування: програмних чи з оберненим зв'язком?

		\item Знайти траєкторію системи, яка відповідає цьому керуванню.

		\item Чи буде ця траєкторія неперервно диференційованою?

		\item Чи буде таке керування кращим в порівнянні з керуванням \[ u(t) = \begin{cases} 0, & \text{якщо } t \in [0, 1], \\ t^2, & \text{якщо } t \in (1, 2], \end{cases} \] за умови, що критерій якості має вигляд \[ \JJ (u) = \int_0^2 u^2(s) \diff s + x_1^2 (2) + x_2^2 (2) \to \min \]
	\end{enumerate}
\end{problem}

\begin{solution}
	\begin{enumerate}
		\item Керування програмне бо не залежить від $x$.

		\item При $t \in [0, 1]$ маємо 
		\[
			\begin{pmatrix}
				\dot x_1 \\ 
				\dot x_2
			\end{pmatrix}
			=
			\begin{pmatrix}
				-1 & -5 \\
				1 & 1
			\end{pmatrix}
			\begin{pmatrix}
				x_1 \\
				x_2
			\end{pmatrix}.
		\]
		Характеристичне рівняння 
		\[
			\begin{vmatrix}
				-1 - \lambda & -5 \\
				1 & 1 - \lambda 
			\end{vmatrix}
			=
			\lambda^2 + 4 
			=
			(\lambda - 2 i) (\lambda + 2i)
			=
			0,
		\]
		звідки $\lambda_1 = - 2 i$, $\lambda_2 = 2 i$.\\
		
		З курсу диференційних рівнянь відомо, що тоді загальний розв'язок має вигляд
		\[
			\begin{pmatrix}
			x_1 \\
			x_2
			\end{pmatrix}
			=
			c_1 v_1 (\cos(2t) - i \sin(2t)) + c_2 v_2 (\cos(2t) + i \sin(2t)),
		\]
		де $v_1$, $v_2$ -- власні вектори, що відповідають $\lambda_1$ та $\lambda_2$ відповідно.\\
		
		Нескладно бачити, що 
		\[
			\begin{pmatrix}
				x_1 \\
				x_2
			\end{pmatrix}
			=
			c_1 
			\begin{pmatrix}
				2 \cos (2t) - \sin (2t) \\
				\sin (2t)
			\end{pmatrix} 
			+ 
			c_2 
			\begin{pmatrix}
				-5 \sin (2t) \\
				\sin(2t) + 2 \cos(2t)
			\end{pmatrix}.
		\]
		
		Підставляючи $t = 0$ отримуємо $c_1 = 0$, $c_2 = 1 / 2$.
		
		При $t \in (1, 2]$ маємо \[...\]

		\item

		\item
	\end{enumerate}
\end{solution}
